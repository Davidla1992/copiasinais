<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - Gibiteka Max Zendron</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#0A1F44,#2B3A67);color:#fff;}
    .container{max-width:1200px;margin:0 auto;padding:1rem;}
    header{background:#2B3A67;padding:1rem 0;box-shadow:0 2px 10px rgba(0,191,255,0.2);}
    .header-flex{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
    .site-title{font-weight:700;color:#00BFFF;}
    .nav-menu{list-style:none;display:flex;gap:1rem;margin:0;padding:0;}
    .nav-menu li a{color:#1E90FF;text-decoration:none;font-weight:600;}
    .nav-menu li a:hover{color:#00BFFF;}
    main{padding:3rem 1rem;text-align:center;}
    form{max-width:420px;margin:0 auto;background:#0A1F44;padding:1.5rem;border-radius:12px;box-shadow:0 0 15px rgba(0,191,255,0.2);}
    input{width:100%;padding:0.75rem;margin:.5rem 0;border:none;border-radius:8px;}
    .button{background:linear-gradient(135deg,#1E90FF,#00BFFF);color:#fff;padding:0.75rem 1rem;border-radius:8px;font-weight:bold;border:none;cursor:pointer;width:100%;}
    .button:hover{transform:scale(1.02);}
    .toggle{margin-top:1rem;color:#E0F7FF;cursor:pointer;}
  </style>
</head>
<body>
  <header>
    <div class="container header-flex">
      <h1 class="site-title">Gibiteka Max Zendron</h1>
      <nav>
        <ul class="nav-menu">
          <li><a href="index.html">Início</a></li>
          <li><a href="acervo.html">Acervo</a></li>
          <li><a href="servicos.html">Serviços</a></li>
          <li><a href="pesquisa.html">Pesquisa</a></li>
          <li><a href="perfil.html">Perfil</a></li>
          <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="login.html">Login</a></li>
          <li><a onclick="logout()">Logout</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <h2>Entrar ou Cadastrar</h2>
    <form id="authForm" onsubmit="handleAuth(event)">
      <input type="email" id="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Senha" required />
      <input type="text" id="name" placeholder="Nome (apenas para cadastro)" style="display:none;" />
      <button class="button" type="submit" id="submitBtn">Entrar</button>
      <div class="toggle" onclick="toggleMode()">Quero me cadastrar</div>
    </form>
  </main>

  <footer>
    <div class="container">&copy; 2025 Gibiteka Max Zendron — Todos os direitos reservados</div>
  </footer>

  <script>
    let isSignup = false;

    function toggleMode() {
      isSignup = !isSignup;
      document.getElementById('name').style.display = isSignup ? 'block' : 'none';
      document.getElementById('submitBtn').textContent = isSignup ? 'Cadastrar' : 'Entrar';
      document.querySelector('.toggle').textContent = isSignup ? 'Já tenho conta' : 'Quero me cadastrar';
    }

    function getUsers() {
      return JSON.parse(localStorage.getItem('users') || '[]');
    }
    function setUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }

    function handleAuth(e) {
      e.preventDefault();
      const email = document.getElementById('email').value.trim().toLowerCase();
      const password = document.getElementById('password').value.trim();
      const name = document.getElementById('name').value.trim();

      const users = getUsers();

      if (isSignup) {
        if (users.find(u => u.email === email)) {
          alert('Já existe uma conta com este email.');
          return;
        }
        const newUser = { email, name: name || 'Usuário', password };
        users.push(newUser);
        setUsers(users);
        localStorage.setItem(`user:${email}`, JSON.stringify({ email, name: newUser.name }));
        localStorage.setItem(`acervo:${email}`, JSON.stringify([]));
        localStorage.setItem('loggedUser', email);
        alert('Cadastro realizado com sucesso!');
        window.location.href = 'dashboard.html';
      } else {
        const user = users.find(u => u.email === email && u.password === password);
        if (!user) {
          alert('Email ou senha inválidos.');
          return;
        }
        localStorage.setItem('loggedUser', email);
        if (!localStorage.getItem(`user:${email}`)) {
          localStorage.setItem(`user:${email}`, JSON.stringify({ email, name: user.name || 'Usuário' }));
        }
        if (!localStorage.getItem(`acervo:${email}`)) {
          localStorage.setItem(`acervo:${email}`, JSON.stringify([]));
        }
        window.location.href = 'dashboard.html';
      }
    }

    function logout() {
      localStorage.removeItem("loggedUser");
      alert("Você saiu da sua conta.");
      window.location.href = "login.html";
    }
  </script>
</body>
</html>
